#include<stdio.h>
#include<stdlib.h>
#include<dirent.h>
#include<sys/types.h>
#include<sys/stat.h>
#include<unistd.h>
#include<string.h>

void showContent(char nom_rep[300])
{
    DIR *rep_ouvert;
    struct dirent *entre;
    struct stat infoEntre;
    int nature=0;
    char *tmp;
    
    
    rep_ouvert= opendir(nom_rep);
    
    
    if (rep_ouvert==NULL)
    {
        
        printf("le dossier n'existe pas ...\n");
        exit(1);

    }
    while((entre=readdir(rep_ouvert))!=NULL)
    {    
	    
	fprintf(stdout,"---%s \n",entre->d_name);
	if((strcmp(entre->d_name, ".")==0) || (strcmp(entre->d_name,"..") ==0))
            continue;

        
        stat(entre->d_name,&infoEntre);    
	printf(" S_ISDIR =%d",S_ISDIR(infoEntre.st_mode));	
        if (S_ISDIR(infoEntre.st_mode))
    	{
      		strcat(nom_rep,"/");
		strcat(nom_rep,entre->d_name);
		showContent(nom_rep);
        }
        
        
    }
    closedir(rep_ouvert);

}

int main(void)
{
    char nom_repertoire[300];
    
    printf(" entrez le nom du repertoire a scillonner : \n");
    scanf("%s",nom_repertoire);
    showContent(nom_repertoire);
     
    
    return 0;
}
